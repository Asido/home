<?php
/**
 * @copyright 68 Classifieds
 *
 * @author 68 Designs, LLC
 * @version $Revision: 85 $
 * @package 68Classifieds
 * @link http://www.68classifieds.com
 *
 * @Updated: $Date: 2008-11-18 14:28:05 -0500 (Tue, 18 Nov 2008) $
 */
?><script type="text/javascript" src="modules/templatecodes/scripts/jquery.swfupload.js"></script><?php
require_once ('includes/init.php');
$class_tpl->caching = false;
if (isset($_REQUEST['mod']))
{
	$mod = $modules->getModuleByName($_REQUEST['mod']);
	$class_tpl->set_module($mod['directory']);
	$language = $Core->settings['language'];
	if ($mod['user_capable'] == 1)
	{
		//include the language file
		if ($language != "")
		{
			if (@file_exists(FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/language/' . $language))
			{
				require_once (FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/language/' . $language);
			}
			elseif (@file_exists(FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/language/english.php'))
			{
				require_once (FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/language/english.php');
			}
		}
		elseif (@file_exists(FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/language/english.php'))
		{
			require_once (FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/language/english.php');
		}
		if (@file_exists(FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/index.php'))
		{
			//$class_tpl = & new Template($mod['name']);
			//@FIXME this is also done in init, why take the variable and reassign?
			$class_tpl->assign('templatepages', $pages);
		require_once (FILESYSTEM_PATH . 'modules/' . $mod['directory'] . '/index.php');
			//require_once (FILESYSTEM_PATH . 'container.php');
		}
		else
		{
			// Goes back to index
			header('Location: index.php');
			exit();
		}
	}
	else
	{
		// Goes back to index
		header('Location: index.php');
		exit();
	}
}
else
{
	// Goes back to index
	header('Location: index.php');
	exit();
}

/* End of file modules.php */
/* Location: ./upload/modules.php */
