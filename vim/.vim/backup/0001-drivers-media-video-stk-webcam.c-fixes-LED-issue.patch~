From 40c1c2732b1b0bd2a20a8b742fb16881a051f726 Mon Sep 17 00:00:00 2001
From: Arvydas Sidorenko <asido4@gmail.com>
Date: Mon, 12 Sep 2011 19:16:41 +0200
Subject: [PATCH 1/2] drivers/media/video/stk-webcam.c: fixes LED issue

The probem was on my DC-1125 webcam chip from Syntek. Whenever the webcam
turns on, the LED light on it is turn on also and never turns off again unless
system is shut downed or restarted.
This patch will fix the issue - the LED will be turned off whenever the stream
from webcam is off.

Signed-off-by: Arvydas Sidorenko <asido4@gmail.com>
---
 drivers/media/video/stk-webcam.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/media/video/stk-webcam.c b/drivers/media/video/stk-webcam.c
index d1a2cef..2ac9a4f 100644
--- a/drivers/media/video/stk-webcam.c
+++ b/drivers/media/video/stk-webcam.c
@@ -162,6 +162,9 @@ static int stk_stop_stream(struct stk_camera *dev)
 		}
 		unset_streaming(dev);
 
+		/* Turn the LED off */
+		stk_camera_write_reg(dev, 0x0, 0x48);
+
 		if (usb_set_interface(dev->udev, 0, 0))
 			STK_ERROR("usb_set_interface failed !\n");
 		if (stk_sensor_sleep(dev))
@@ -180,9 +183,12 @@ static int stk_stop_stream(struct stk_camera *dev)
 
 static struct regval stk1125_initvals[] = {
 	/*TODO: What means this sequence? */
+
+	/* writing the first 3 turns the LED on */
 	{0x0000, 0x24},
 	{0x0100, 0x21},
 	{0x0002, 0x68},
+
 	{0x0003, 0x80},
 	{0x0005, 0x00},
 	{0x0007, 0x03},
-- 
1.7.4.4

