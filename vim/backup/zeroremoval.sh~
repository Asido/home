#!/bin/bash

trap 'rm -f $temp ; exit 1' INT 
trap 'rm -f $temp' 0

remove=false

if [[ $# < 1 || $# > 3 ]]; then
	echo "Usage: $(basename $0) [-rf] folder" 1>&2
	exit 1
fi

while getopts :f arg; do
	case $arg in
		f)
			remove=true	;;
		\?)
			echo "$(basename $0): Invalid option -$OPTARG ignored." 1>&2 ;;
	esac
done

args=("$@")
folder=${args[(($#-1))]}
temp=/tmp/$$.temp

echo "Looking for a zero size files..."
echo "This might take a while..."
find "$folder" -size 0 -type f > $temp 2> /dev/null
echo
echo "Done!"
echo -e "\v"

confirm="Y"
while read file; do
	echo "$file"
	if [[ $remove = "false" ]]; then
		echo -n "Do you want to delete this file? (Y/N): "
		read confirm <&1
	fi
	if [[ "$confirm" =~ [yY] ]]; then
		rm -f "$file"
		echo "Deleted!"
	fi
	echo
done < "$temp"
