;*******************************************************
;		gdt.inc
;			- GDT (Global Descriptor Table) Routines
;*******************************************************

%ifndef __GDT_INC_
%define __GDT_INC_

bits 16

;------------------------------------------
; INSTALL_GDT()
;	- Install our GDT
;------------------------------------------
INSTALL_GDT:
	cli				; clear interrupts
	pusha			; save registers
	lgdt [TOC]		; load GDT into GDTR (register)
	sti				; enable interrupts
	popa			; restore registers
	ret				; All done!


;-------------------------------------
; Global Descriptor Table (GDT)
;-------------------------------------
GDT_DATA:
	; null descriptor
	dd 0
	dd 0

	; code descriptor
	dw 0xFFFF		; limit low
	dw 0			; base low
	db 0			; base middle
	db 10011010b	; access
	db 11001111b	; granularity
	db 0			; base high

	; data descriptor
	dw 0xFFFF		; limit low
	dw 0			; base low
	db 0			; base middle
	db 10010010b	; access
	db 11001111b	; granularity
	db 0			; base high
END_OF_GDT:

TOC:

%endif ; __GDT_INC_
