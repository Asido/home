// JavaScript Document
$('#selectedimages').html('');
$(function(){

var btnUpload=$('#select_uploadimagefile');
		new AjaxUpload(btnUpload, {
			action: 'upload.php',
			name: 'uploadfile',
			onSubmit: function(file, ext){
				 if (! (ext && /^(jpg|png|jpeg|gif)$/.test(ext))){ 
                    // extension is not allowed 
					return false;
				}
				$('#progress').html('<img src="images/ajax-loader.gif" style="margin-left:auto; margin-right:auto;" />');
			},
			onComplete: function(file, response){
				//On completion clear the status
				$('#progress').html('');
			//	document.location.reload();
				//Add uploaded file to list
				if(response.length > 0){
					if($('#selectedimages')=='<table width="100%" height="140"><tr><td width="100%"style="text-align:center">Images Uploaded</td></tr></table>')
					{
						$('#selectedimages').html('<img style="float:left;margin-bottom:3px;" class="m_photoframe_115" src="uploads/'+response+'.jpg" />');
					}
					else
					{
					$('#selectedimages').append('<img style="float:left;margin-bottom:3px;" class="m_photoframe_115" src="uploads/'+response+'.jpg" />');
					}
					
				} else{
					
				}
			}
		});
		var btnUpload=$('#mappdf');
		new AjaxUpload(btnUpload, {
			action: 'uploadpdfmap.php',
			name: 'uploadfile',
			onSubmit: function(file, ext){
				 if (! (ext && /^(pdf)$/.test(ext))){ 
                    alert('Invalid Extension ');
					return false;
				}
				//alert('submitting');
			},
			onComplete: function(file, response){

			$('#mapimg').attr('src','images/lg_map_pdf.png');
			$('#mapimga').attr('href','uploads/maps/'+response);
			$('#sv_mapurl').attr('value','uploads/maps/'+response);
			console.log($('#sv_mapurl').val());
			}
		});
		$('div#facebox>.popup>.content>.dialog>.dialog-body>input#googlemapurl1').click(function(){
		$('div#facebox>.popup>.content>.dialog>.dialog-body>input#googlemapurl1').css('border','#000 thin solid');
		});
});

function google_click()
{
				jQuery.facebox({div: '#savemap'});
				 $('.close_image').attr({'src':'images/rij_close.png','opacity':1});
			

	
}
function validate_map() //Works when Save button clicked in Save Map Popup
{
	
	if($('div#facebox>.popup>.content>.dialog>.dialog-body>input#googlemapurl1').val()=="")
	{
		$('div#facebox>.popup>.content>.dialog>.dialog-body>input#googlemapurl1').attr("placeholder","Enter Google Map URL");
		$('div#facebox>.popup>.content>.dialog>.dialog-body>input#googlemapurl1').css('border','#f00 thin solid');	
		return false;
	
	}
	else
	{
		
		$('#sv_mapurl').attr('value',$('div#facebox>.popup>.content>.dialog>.dialog-body>input#googlemapurl1').val()); //set map link
		$('#mapimg').attr('src','images/m_map_bg.png');//changes image 
		$('#mapimga').attr('href',$('#sv_mapurl').val());//change link
		jQuery(document).trigger('close.facebox');
		
		
	}
}
function setmaplink()
{
	$.ajax({
	   	type: "POST",
   		url: "savemap.php",
   		data: "googleurl="+$('#googlemapiframe').val()+"&&link="+$('#googlemapurl').val(),
  		success: function(msg){
     	jQuery(document).trigger('close.facebox');
		
   }
 });


}
function upload_images()
{

if($('#selectedimages img').size()<1)
{
	alert("Select Images to Upload");
	return false;
}
else
{

	//alert("hi");
	var images = [];
	
	$('#selectedimages img').each(function(index){
		images.push($(this).attr('src'));
		});
		
	tour_id = $('#tour_id').val();	
		
		$.ajax({
			   type: "POST",
			   url: "uploadscripts/uploadpictures.php",
			   data: "images="+images+"&&tour_id="+tour_id,
			   success: function(msg){
				   //alert(msg);
				 //$('#selectedimages').fadeOut();  
				 $('#selectedimages').html('<table width="100%" height="140"><tr><td width="100%"style="text-align:center">Images Uploaded</td></tr></table>');
				$('#selectedimages').animate('opacity',0.9,1000);
							 $('#selectedimages').html('');		 
				 //$('#selectedimages').fadeIn();  
			   }
			 });
		
		
}
}

function submitTour(id)
{
	if(id==1)
	{
		$('#tourstatus').val('save');
		$('#dataform').submit();
	}
	else if(id==2)
	{
		$('#tourstatus').val('submit');
		$('#dataform').submit();
	}
}
function upload_tour()
{
		
		
		if($('#videoTypeAudio').attr("checked")==true)
		{
			var tour_id_value = $('#tour_id').val();
			jQuery.facebox('<iframe id="uploadaudio1" scrolling="no" src="uploadmoviesshow.php?tour_id='+tour_id_value+'&&type=audio" style="width:680px; height:350px; overflow:hidden; margin: 0px;padding: 0px;border: none;"></iframe>');
		
		}

		else if($('#videoTypeVideo').attr("checked")==true)
		{
			var tour_id_value = $('#tour_id').val();
			jQuery.facebox('<iframe scrolling="no" src="uploadmoviesshow.php?tour_id='+tour_id_value+'&&type=video" style="width:680px; height:350px; margin: 0px;padding: 0px;border: none;"></iframe>');
			
		}
		else
		{
			alert("Select the file type you want to upload");
		}
		
		
}		
	

	
function upload_map()
{
		if($('#sv_mapurl').val()=="")
		{
			alert("Select a map");
		}
		else
		{
			$('#m_map_wrapper').html('<table width="100%" height="140"><tr><td width="100%"style="text-align:center">Maps Uploaded</td></tr></table>');
		}
		//alert("Select a map");
}

//7873ee5f08874875c22112b375989dc6470c8fb5
